<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0f0f1e">
  <title>ğŸ± ë¡œë˜ ë¶„ì„ê¸°</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    :root{--bg:#0f0f1e;--card:#1a1a2e;--card2:#252542;--primary:#667eea;--primary2:#764ba2;--text:#fff;--text2:#888899;--success:#51cf66;--danger:#ff6b6b;--warning:#ffd43b}
    html,body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);min-height:100vh;color:var(--text)}
    .app{max-width:500px;margin:0 auto;padding:16px;padding-bottom:80px}
    .header{text-align:center;background:linear-gradient(135deg,var(--primary),var(--primary2));margin:-16px -16px 16px;padding:24px 16px}
    .header h1{font-size:1.5rem;margin-bottom:4px}.header p{font-size:12px;opacity:.8}
    .bottom-nav{position:fixed;bottom:0;left:0;right:0;background:var(--card);display:flex;justify-content:space-around;padding:8px 0;padding-bottom:max(8px,env(safe-area-inset-bottom));border-top:1px solid rgba(255,255,255,.1);z-index:100}
    .nav-item{display:flex;flex-direction:column;align-items:center;padding:8px 12px;color:var(--text2);font-size:10px;background:none;border:none;cursor:pointer}
    .nav-item.active{color:var(--primary)}.nav-item span{font-size:20px;margin-bottom:2px}
    .card{background:var(--card);border-radius:16px;padding:16px;margin-bottom:12px}
    .card-title{font-size:14px;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px}
    .card-highlight{background:linear-gradient(135deg,rgba(102,126,234,.15),rgba(118,75,162,.15));border:1px solid rgba(102,126,234,.3)}
    .balls{display:flex;gap:6px;justify-content:center;align-items:center;flex-wrap:wrap}
    .ball{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;color:#fff}
    .ball.sm{width:32px;height:32px;font-size:12px}.ball.xs{width:26px;height:26px;font-size:10px}
    .ball.b1{background:linear-gradient(135deg,#ffd700,#f0a500)}.ball.b2{background:linear-gradient(135deg,#4dabf7,#228be6)}
    .ball.b3{background:linear-gradient(135deg,#ff6b6b,#e03131)}.ball.b4{background:linear-gradient(135deg,#868e96,#495057)}
    .ball.b5{background:linear-gradient(135deg,#51cf66,#2f9e44)}.ball.bonus{box-shadow:0 0 0 3px var(--bg),0 0 0 5px var(--primary)}
    .ball.matched{box-shadow:0 0 0 3px var(--success)}.plus{color:var(--text2);font-size:16px;margin:0 4px}
    
    .accordion{border-radius:12px;overflow:hidden;background:var(--card2);margin-bottom:12px}
    .accordion-header{padding:14px 16px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-size:13px}
    .accordion-header:hover{background:rgba(255,255,255,.05)}
    .accordion-icon{transition:transform .2s}
    .accordion.open .accordion-icon{transform:rotate(180deg)}
    .accordion-content{max-height:0;overflow:hidden;transition:max-height .3s}
    .accordion.open .accordion-content{max-height:500px}
    .accordion-inner{padding:0 16px 16px}
    
    .number-grid{display:grid;grid-template-columns:repeat(9,1fr);gap:4px}
    .number-btn{aspect-ratio:1;border:none;border-radius:8px;font-weight:600;font-size:11px;cursor:pointer;transition:all .15s}
    .number-btn.b1{background:rgba(255,215,0,.2);color:#ffd700}.number-btn.b2{background:rgba(77,171,247,.2);color:#4dabf7}
    .number-btn.b3{background:rgba(255,107,107,.2);color:#ff6b6b}.number-btn.b4{background:rgba(134,142,150,.2);color:#868e96}
    .number-btn.b5{background:rgba(81,207,102,.2);color:#51cf66}
    .number-btn.selected{background:var(--primary)!important;color:#fff!important}
    .number-btn.excluded{background:var(--danger)!important;color:#fff!important}
    .number-btn.required{background:var(--success)!important;color:#fff!important}
    
    .btn{width:100%;padding:14px;border:none;border-radius:12px;font-size:15px;font-weight:600;cursor:pointer}
    .btn:active{transform:scale(.98)}.btn-primary{background:linear-gradient(135deg,var(--primary),var(--primary2));color:#fff}
    .btn-success{background:linear-gradient(135deg,#51cf66,#2f9e44);color:#fff}
    .btn-outline{background:transparent;border:1px solid var(--primary);color:var(--primary)}
    .btn-sm{padding:10px 16px;font-size:13px;width:auto}
    
    .round-nav{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:16px}
    .round-nav button{width:44px;height:44px;border-radius:50%;border:none;background:var(--card2);color:var(--text);font-size:18px;cursor:pointer}
    .round-nav button:disabled{opacity:.3}.round-nav button:active:not(:disabled){background:var(--primary)}
    .round-display{text-align:center;cursor:pointer;min-width:120px}
    .round-num{font-size:24px;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--primary2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .round-date{font-size:12px;color:var(--text2)}
    
    .prize-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:12px}
    .prize-item{background:var(--card2);padding:10px;border-radius:10px;text-align:center}
    .prize-item.main{grid-column:span 2;background:linear-gradient(135deg,rgba(255,215,0,.15),rgba(255,107,107,.15));border:1px solid rgba(255,215,0,.3)}
    .prize-label{font-size:10px;color:var(--text2)}.prize-value{font-size:16px;font-weight:700}
    .prize-value.highlight{color:var(--warning);font-size:20px}
    .prize-sub{font-size:10px;color:var(--text2);margin-top:2px}
    .prize-net{font-size:11px;color:var(--success);margin-top:2px}
    
    .check-result{text-align:center;padding:16px;background:var(--card2);border-radius:12px;margin:12px 0}
    .check-rank{font-size:32px;font-weight:800}
    .check-rank.win{background:linear-gradient(135deg,var(--warning),#ff6b6b);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .check-rank.lose{color:var(--text2)}
    
    .info-box{background:var(--card2);border-radius:10px;padding:12px;font-size:12px;line-height:1.6}
    .info-box h4{color:var(--primary);margin-bottom:8px;font-size:13px}
    .info-row{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid rgba(255,255,255,.05)}
    .info-row:last-child{border:none}
    
    .modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);z-index:200;align-items:center;justify-content:center}
    .modal-overlay.active{display:flex}
    .modal{background:var(--card);border-radius:16px;padding:24px;width:90%;max-width:320px}
    .modal h3{margin-bottom:16px;text-align:center;font-size:16px}
    .modal input{width:100%;padding:14px;border:none;border-radius:12px;background:var(--card2);color:var(--text);font-size:18px;text-align:center;margin-bottom:12px}
    .modal-buttons{display:flex;gap:8px}.modal-buttons button{flex:1}
    
    .tabs{display:flex;gap:6px;margin-bottom:16px}
    .tab{flex:1;padding:10px;border-radius:10px;font-size:12px;background:var(--card2);color:var(--text2);border:none;cursor:pointer;text-align:center}
    .tab.active{background:var(--primary);color:#fff}
    
    .stat-table{width:100%;border-collapse:collapse;font-size:11px}
    .stat-table th,.stat-table td{padding:8px 6px;text-align:center;border-bottom:1px solid var(--card2)}
    .stat-table th{background:var(--card2);color:var(--text2);cursor:pointer;position:sticky;top:0;font-weight:500}
    .stat-table th:hover{background:var(--primary);color:#fff}
    .stat-table tr:hover{background:rgba(102,126,234,.1)}
    .table-scroll{max-height:350px;overflow-y:auto;border-radius:8px}
    
    .filter-bar{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap}
    .filter-chip{padding:6px 10px;border-radius:14px;font-size:10px;background:var(--card2);color:var(--text2);border:none;cursor:pointer}
    .filter-chip.active{background:var(--primary);color:#fff}
    
    .help-icon{display:inline-flex;align-items:center;justify-content:center;width:16px;height:16px;border-radius:50%;background:var(--card2);color:var(--text2);font-size:10px;cursor:pointer;margin-left:4px}
    .help-icon:hover{background:var(--primary);color:#fff}
    
    .tooltip{position:relative}.tooltip-text{display:none;position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:var(--card);border:1px solid var(--primary);padding:8px 12px;border-radius:8px;font-size:11px;white-space:nowrap;z-index:10}
    .tooltip:hover .tooltip-text{display:block}
    
    .checkbox-group{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}
    .checkbox-item{display:flex;align-items:center;gap:6px;padding:8px 12px;background:var(--card2);border-radius:8px;cursor:pointer;font-size:12px}
    .checkbox-item input{display:none}
    .checkbox-item.checked{background:var(--primary)}
    .checkbox-box{width:16px;height:16px;border:2px solid var(--text2);border-radius:4px;display:flex;align-items:center;justify-content:center}
    .checkbox-item.checked .checkbox-box{border-color:#fff;background:rgba(255,255,255,.2)}
    .checkbox-item.checked .checkbox-box::after{content:'âœ“';color:#fff;font-size:10px}
    
    .predict-result{background:linear-gradient(135deg,rgba(102,126,234,.1),rgba(118,75,162,.1));border:1px solid rgba(102,126,234,.3);border-radius:12px;padding:12px;margin-bottom:8px}
    .predict-index{font-size:11px;color:var(--primary);margin-bottom:8px}
    
    .section{display:none}.section.active{display:block}
    .loading{text-align:center;padding:60px 20px}
    .spinner{width:40px;height:40px;border:4px solid var(--card2);border-top-color:var(--primary);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 16px}
    @keyframes spin{to{transform:rotate(360deg)}}
    
    .alert{padding:10px 12px;border-radius:8px;font-size:12px;margin-bottom:12px}
    .alert-danger{background:rgba(255,107,107,.2);color:var(--danger)}
    .alert-success{background:rgba(81,207,102,.2);color:var(--success)}
    
    .selected-display{display:flex;align-items:center;gap:8px;min-height:32px}
    .selected-label{font-size:11px;color:var(--text2)}
    
    .wheel-section{margin-top:16px;padding-top:16px;border-top:1px solid var(--card2)}
    .wheel-info{font-size:11px;color:var(--text2);margin-bottom:8px}
    .wheel-result{max-height:200px;overflow-y:auto}
    .wheel-item{padding:8px;background:var(--card2);border-radius:8px;margin-bottom:4px;font-size:12px;text-align:center}
    
    .input{width:100%;padding:12px;border:none;border-radius:10px;background:var(--card2);color:var(--text);font-size:14px}
    
    .pair-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-top:8px}
    .pair-item{background:var(--card2);padding:8px;border-radius:8px;text-align:center;font-size:11px}
    .pair-num{font-weight:700;color:var(--primary)}
  </style>
</head>
<body>
<div class="app">
  <header class="header"><h1>ğŸ± ë¡œë˜ ë¶„ì„ê¸°</h1><p>ë‹¹ì²¨ë²ˆí˜¸ ì¡°íšŒ Â· í†µê³„ ë¶„ì„ Â· AI ì˜ˆì¸¡</p></header>
  
  <div id="loading" class="loading"><div class="spinner"></div><p>ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p></div>
  
  <!-- í™ˆ -->
  <div id="sec-home" class="section">
    <!-- ë‚´ ë²ˆí˜¸ ì…ë ¥ ì•„ì½”ë””ì–¸ -->
    <div class="accordion open" id="myNumAccordion">
      <div class="accordion-header" onclick="toggleAccordion('myNumAccordion')">
        <div>
          <span>ğŸ« ë‚´ ë²ˆí˜¸</span>
          <span id="myNumDisplay" style="margin-left:8px"></span>
        </div>
        <span class="accordion-icon">â–¼</span>
      </div>
      <div class="accordion-content">
        <div class="accordion-inner">
          <p style="font-size:11px;color:var(--text2);margin-bottom:10px">6ê°œ ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
          <div class="number-grid" id="checkGrid"></div>
          <button class="btn btn-outline btn-sm" onclick="clearCheck()" style="margin-top:8px;width:auto">ì´ˆê¸°í™”</button>
        </div>
      </div>
    </div>
    
    <button class="btn btn-success" onclick="checkMyNumbers()" style="margin-bottom:16px">ğŸ” ë‹¹ì²¨ í™•ì¸</button>
    
    <div id="checkResult"></div>
    
    <!-- íšŒì°¨ ì •ë³´ -->
    <div class="card card-highlight">
      <div class="round-nav">
        <button onclick="prevRound()" id="prevBtn">â—€</button>
        <div class="round-display" onclick="openRoundModal()">
          <div class="round-num" id="currentRound">-</div>
          <div class="round-date" id="currentDate">í„°ì¹˜í•˜ì—¬ íšŒì°¨ ì…ë ¥</div>
        </div>
        <button onclick="nextRound()" id="nextBtn">â–¶</button>
      </div>
      
      <div class="balls" id="currentBalls"></div>
      
      <div class="prize-grid">
        <div class="prize-item main">
          <div class="prize-label">ğŸ† 1ë“± (1ì¸ë‹¹)</div>
          <div class="prize-value highlight" id="prize1">-</div>
          <div class="prize-net" id="prize1Net">ì‹¤ìˆ˜ë ¹: -</div>
          <div class="prize-sub" id="prize1Info">-</div>
        </div>
        <div class="prize-item">
          <div class="prize-label">2ë“±</div>
          <div class="prize-value" id="prize2">-</div>
          <div class="prize-sub" id="prize2Info">-</div>
        </div>
        <div class="prize-item">
          <div class="prize-label">3ë“±</div>
          <div class="prize-value" id="prize3">-</div>
          <div class="prize-sub" id="prize3Info">-</div>
        </div>
        <div class="prize-item">
          <div class="prize-label">ì´ íŒë§¤ì•¡</div>
          <div class="prize-value" id="totalSales">-</div>
        </div>
        <div class="prize-item">
          <div class="prize-label">ì´ ë‹¹ì²¨ì</div>
          <div class="prize-value" id="totalWinners">-</div>
        </div>
      </div>
    </div>
    
    <!-- ë‹¹ì²¨ ì¡°ê±´ ì•ˆë‚´ -->
    <div class="card">
      <div class="card-title">ğŸ“‹ ë‹¹ì²¨ ì¡°ê±´</div>
      <div class="info-box">
        <div class="info-row"><span>ğŸ¥‡ 1ë“±</span><span>6ê°œ ë²ˆí˜¸ ì¼ì¹˜</span></div>
        <div class="info-row"><span>ğŸ¥ˆ 2ë“±</span><span>5ê°œ + ë³´ë„ˆìŠ¤ ì¼ì¹˜</span></div>
        <div class="info-row"><span>ğŸ¥‰ 3ë“±</span><span>5ê°œ ë²ˆí˜¸ ì¼ì¹˜</span></div>
        <div class="info-row"><span>4ë“±</span><span>4ê°œ ë²ˆí˜¸ ì¼ì¹˜ (ê³ ì • 5ë§Œì›)</span></div>
        <div class="info-row"><span>5ë“±</span><span>3ê°œ ë²ˆí˜¸ ì¼ì¹˜ (ê³ ì • 5ì²œì›)</span></div>
      </div>
    </div>
  </div>
  
  <!-- ì˜ˆì¸¡ -->
  <div id="sec-predict" class="section">
    <div class="card">
      <div class="card-title">âš™ï¸ ì˜ˆì¸¡ ì˜µì…˜ <span class="help-icon tooltip">?<span class="tooltip-text">ì²´í¬í•œ ì¡°ê±´ë“¤ì„ ì¡°í•©í•˜ì—¬ ì˜ˆì¸¡í•©ë‹ˆë‹¤<br>ì²´í¬ ì—†ìœ¼ë©´ ì™„ì „ ëœë¤</span></span></div>
      
      <div class="checkbox-group" id="optionGroup">
        <label class="checkbox-item" onclick="toggleOption(this,'oddEven')">
          <div class="checkbox-box"></div><span>í™€ì§ ê· í˜•(3:3)</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'highLow')">
          <div class="checkbox-box"></div><span>ê³ ì € ê· í˜•(3:3)</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'sumRange')">
          <div class="checkbox-box"></div><span>ì´í•© 100-175</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'hot')">
          <div class="checkbox-box"></div><span>HOT ë²ˆí˜¸ í¬í•¨</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'cold')">
          <div class="checkbox-box"></div><span>COLD ë²ˆí˜¸ í¬í•¨</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'noConsec')">
          <div class="checkbox-box"></div><span>ì—°ì†ë²ˆí˜¸ ì œì™¸</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'colorBalance')">
          <div class="checkbox-box"></div><span>ìƒ‰ìƒ ê· í˜•</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'recentTrend')">
          <div class="checkbox-box"></div><span>ìµœê·¼ íŠ¸ë Œë“œ</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'longAbsent')">
          <div class="checkbox-box"></div><span>ë¯¸ì¶œí˜„ ë²ˆí˜¸</span>
        </label>
        <label class="checkbox-item" onclick="toggleOption(this,'endNumBalance')">
          <div class="checkbox-box"></div><span>ëìˆ˜ ë¶„ì‚°</span>
        </label>
      </div>
      
      <!-- ì œì™¸ ë²ˆí˜¸ ì•„ì½”ë””ì–¸ -->
      <div class="accordion" id="excludeAccordion">
        <div class="accordion-header" onclick="toggleAccordion('excludeAccordion')">
          <div>
            <span>ğŸš« ì œì™¸ ë²ˆí˜¸</span>
            <span id="excludeDisplay" style="margin-left:8px;color:var(--danger)"></span>
          </div>
          <span class="accordion-icon">â–¼</span>
        </div>
        <div class="accordion-content">
          <div class="accordion-inner">
            <div class="number-grid" id="excludeGrid"></div>
          </div>
        </div>
      </div>
      
      <!-- í•„ìˆ˜ ë²ˆí˜¸ ì•„ì½”ë””ì–¸ -->
      <div class="accordion" id="requireAccordion">
        <div class="accordion-header" onclick="toggleAccordion('requireAccordion')">
          <div>
            <span>â­ í•„ìˆ˜ ë²ˆí˜¸ (ìµœëŒ€5ê°œ)</span>
            <span id="requireDisplay" style="margin-left:8px;color:var(--success)"></span>
          </div>
          <span class="accordion-icon">â–¼</span>
        </div>
        <div class="accordion-content">
          <div class="accordion-inner">
            <div class="number-grid" id="requireGrid"></div>
          </div>
        </div>
      </div>
      
      <div style="display:flex;align-items:center;gap:12px;margin:16px 0">
        <span style="font-size:12px;color:var(--text2)">ìƒì„± ê°œìˆ˜:</span>
        <button class="btn btn-outline btn-sm" onclick="adjustCount(-1)">âˆ’</button>
        <span id="predictCount" style="font-size:18px;font-weight:700;min-width:30px;text-align:center">3</span>
        <button class="btn btn-outline btn-sm" onclick="adjustCount(1)">+</button>
      </div>
      
      <button class="btn btn-primary" onclick="generatePrediction()">âœ¨ ë²ˆí˜¸ ìƒì„±</button>
    </div>
    
    <div id="predictResults"></div>
    
    <!-- ì¶•ì†Œ ì‹œìŠ¤í…œ -->
    <div class="card">
      <div class="card-title">ğŸ¯ ì¶•ì†Œ ì‹œìŠ¤í…œ <span class="help-icon tooltip">?<span class="tooltip-text">Nê°œ ë²ˆí˜¸ ì„ íƒ â†’ ê°€ëŠ¥í•œ 6ê°œ ì¡°í•© ìƒì„±<br>ì˜ˆ: 8ê°œ ì„ íƒ â†’ 28ê°œ ì¡°í•©</span></span></div>
      <div class="accordion" id="wheelAccordion">
        <div class="accordion-header" onclick="toggleAccordion('wheelAccordion')">
          <div>
            <span>ë²ˆí˜¸ ì„ íƒ</span>
            <span id="wheelDisplay" style="margin-left:8px;color:var(--primary)"></span>
          </div>
          <span class="accordion-icon">â–¼</span>
        </div>
        <div class="accordion-content">
          <div class="accordion-inner">
            <div class="number-grid" id="wheelGrid"></div>
          </div>
        </div>
      </div>
      <button class="btn btn-outline" onclick="generateWheel()">ì¡°í•© ìƒì„±</button>
      <div id="wheelResults" style="margin-top:12px"></div>
    </div>
  </div>
  
  <!-- í†µê³„ -->
  <div id="sec-stats" class="section">
    <div class="tabs">
      <button class="tab active" onclick="showStatTab('number',this)">ë²ˆí˜¸ë³„</button>
      <button class="tab" onclick="showStatTab('round',this)">íšŒì°¨ë³„</button>
    </div>
    
    <!-- ë²ˆí˜¸ë³„ í†µê³„ -->
    <div id="stat-number" class="stat-content">
      <div class="card">
        <div class="card-title">ğŸ“Š ë²ˆí˜¸ë³„ í†µê³„ 
          <span class="help-icon tooltip">?<span class="tooltip-text">HOT: Z>1.5 (í‰ê· ë³´ë‹¤ ë§ì´ ì¶œí˜„)<br>COLD: Z<-1.5 (í‰ê· ë³´ë‹¤ ì ê²Œ ì¶œí˜„)<br>Z-Score = (ì¶œí˜„-í‰ê· )/í‘œì¤€í¸ì°¨</span></span>
        </div>
        <div class="filter-bar">
          <button class="filter-chip active" onclick="filterNum('all',this)">ì „ì²´</button>
          <button class="filter-chip" onclick="filterNum('1-10',this)">1-10</button>
          <button class="filter-chip" onclick="filterNum('11-20',this)">11-20</button>
          <button class="filter-chip" onclick="filterNum('21-30',this)">21-30</button>
          <button class="filter-chip" onclick="filterNum('31-40',this)">31-40</button>
          <button class="filter-chip" onclick="filterNum('41-45',this)">41-45</button>
          <button class="filter-chip" onclick="filterNum('hot',this)">ğŸ”¥HOT</button>
          <button class="filter-chip" onclick="filterNum('cold',this)">â„ï¸COLD</button>
        </div>
        <div class="table-scroll">
          <table class="stat-table">
            <thead><tr>
              <th onclick="sortNum('num')">ë²ˆí˜¸</th>
              <th onclick="sortNum('count')">ì¶œí˜„</th>
              <th onclick="sortNum('percent')">ë¹„ìœ¨</th>
              <th onclick="sortNum('last')">ë¯¸ì¶œí˜„</th>
              <th onclick="sortNum('zscore')">Zê°’</th>
              <th>ìƒíƒœ</th>
            </tr></thead>
            <tbody id="numTableBody"></tbody>
          </table>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ’‘ ê¶í•© ë²ˆí˜¸ <span class="help-icon tooltip">?<span class="tooltip-text">íŠ¹ì • ë²ˆí˜¸ì™€ í•¨ê»˜<br>ìì£¼ ì¶œí˜„í•˜ëŠ” ë²ˆí˜¸</span></span></div>
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:12px">
          <span style="font-size:12px;color:var(--text2)">ë²ˆí˜¸ ì„ íƒ:</span>
          <select id="pairSelect" class="input" style="width:80px;padding:8px" onchange="showPairNumbers()">
            <option value="">-</option>
          </select>
        </div>
        <div id="pairResult"></div>
      </div>
    </div>
    
    <!-- íšŒì°¨ë³„ í†µê³„ -->
    <div id="stat-round" class="stat-content" style="display:none">
      <div class="card">
        <div class="card-title">âš–ï¸ í™€ì§ ë¶„í¬</div>
        <div class="table-scroll" style="max-height:200px">
          <table class="stat-table">
            <thead><tr><th>í™€:ì§</th><th>íšŸìˆ˜</th><th>ë¹„ìœ¨</th></tr></thead>
            <tbody id="oddEvenBody"></tbody>
          </table>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ“ ê³ ì € ë¶„í¬ (1-22 vs 23-45)</div>
        <div class="table-scroll" style="max-height:200px">
          <table class="stat-table">
            <thead><tr><th>ì €:ê³ </th><th>íšŸìˆ˜</th><th>ë¹„ìœ¨</th></tr></thead>
            <tbody id="highLowBody"></tbody>
          </table>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ”¢ ì´í•© í†µê³„</div>
        <div id="sumStats" class="info-box"></div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ”— ì—°ì†ë²ˆí˜¸ / ACê°’</div>
        <div id="consecStats" class="info-box"></div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ”„ ì´ì›” ë²ˆí˜¸ <span class="help-icon tooltip">?<span class="tooltip-text">ì´ì „ íšŒì°¨ ë²ˆí˜¸ ì¤‘<br>ë‹¤ìŒ íšŒì°¨ì— ë‹¤ì‹œ ë‚˜ì˜¨ ê°œìˆ˜</span></span></div>
        <div id="carryStats" class="info-box"></div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ”š ëìˆ˜ ë¶„í¬ (0-9)</div>
        <div class="table-scroll" style="max-height:200px">
          <table class="stat-table">
            <thead><tr><th>ëìˆ˜</th><th>íšŸìˆ˜</th><th>ë¹„ìœ¨</th></tr></thead>
            <tbody id="endNumBody"></tbody>
          </table>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ“ ë²ˆí˜¸ ê°„ê²© ë¶„ì„</div>
        <div id="gapStats" class="info-box"></div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ¨ ìƒ‰ìƒ(ë²ˆí˜¸ëŒ€) ë¶„í¬</div>
        <div class="table-scroll" style="max-height:200px">
          <table class="stat-table">
            <thead><tr><th>ë²ˆí˜¸ëŒ€</th><th>í‰ê· ê°œìˆ˜</th><th>ë¹„ìœ¨</th></tr></thead>
            <tbody id="colorBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì„¤ì • -->
  <div id="sec-settings" class="section">
    <div class="card">
      <div class="card-title">ğŸ“Š ë°ì´í„° í˜„í™©</div>
      <div id="dataStatus" class="info-box"></div>
    </div>
    <div class="card">
      <div class="card-title">ğŸ”„ ê´€ë¦¬</div>
      <button class="btn btn-outline" onclick="location.reload()" style="margin-bottom:8px">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
      <button class="btn btn-outline" onclick="exportData()">ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
    </div>
    <div class="card">
      <div class="card-title">â„¹ï¸ ìš©ì–´ ì„¤ëª…</div>
      <div class="info-box">
        <div class="info-row"><span>Z-Score</span><span>(ì¶œí˜„ìˆ˜-í‰ê· )/í‘œì¤€í¸ì°¨</span></div>
        <div class="info-row"><span>HOT</span><span>Z > 1.5 (ìì£¼ ì¶œí˜„)</span></div>
        <div class="info-row"><span>COLD</span><span>Z < -1.5 (ì ê²Œ ì¶œí˜„)</span></div>
        <div class="info-row"><span>ACê°’</span><span>ë²ˆí˜¸ê°„ ì°¨ì´ì˜ ì¢…ë¥˜ ìˆ˜ - 5</span></div>
        <div class="info-row"><span>ì´ì›”</span><span>ì´ì „íšŒì°¨ ë²ˆí˜¸ ì¬ì¶œí˜„</span></div>
      </div>
    </div>
    <div class="card">
      <p style="font-size:11px;color:var(--text2);line-height:1.6">âš ï¸ ë¡œë˜ëŠ” ì™„ì „í•œ ë¬´ì‘ìœ„ ì¶”ì²¨ì…ë‹ˆë‹¤. ëª¨ë“  í†µê³„ì™€ ì˜ˆì¸¡ì€ ì°¸ê³ ìš©ì´ë©° ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    </div>
  </div>
</div>

<!-- íšŒì°¨ ì…ë ¥ ëª¨ë‹¬ -->
<div class="modal-overlay" id="roundModal">
  <div class="modal">
    <h3>íšŒì°¨ ì…ë ¥</h3>
    <input type="number" id="roundInput" placeholder="íšŒì°¨ ë²ˆí˜¸" inputmode="numeric">
    <div class="modal-buttons">
      <button class="btn btn-outline" onclick="closeRoundModal()">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="goToRound()">ì´ë™</button>
    </div>
  </div>
</div>

<!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
<nav class="bottom-nav">
  <button class="nav-item active" onclick="showSection('home',this)"><span>ğŸ </span>í™ˆ</button>
  <button class="nav-item" onclick="showSection('predict',this)"><span>ğŸ”®</span>ì˜ˆì¸¡</button>
  <button class="nav-item" onclick="showSection('stats',this)"><span>ğŸ“Š</span>í†µê³„</button>
  <button class="nav-item" onclick="showSection('settings',this)"><span>âš™ï¸</span>ì„¤ì •</button>
</nav>

<script>
// ì „ì—­ ë³€ìˆ˜
let lottoData=[], currentIndex=0, checkNumbers=new Set(), excludedNumbers=new Set(), requiredNumbers=new Set(), wheelNumbers=new Set();
let predictCount=3, numStats=[], predictOptions=new Set();
let numSort={key:'num',asc:true}, numFilter='all', pairData={};

// ì´ˆê¸°í™”
async function init(){
  try{
    const res=await fetch('lotto_data.json');
    if(!res.ok) throw new Error('ë°ì´í„° ì—†ìŒ');
    lottoData=await res.json();
    lottoData.sort((a,b)=>b.round-a.round);
    document.getElementById('loading').style.display='none';
    document.getElementById('sec-home').classList.add('active');
    initAllGrids();
    calculateAllStats();
    renderCurrentRound();
    renderAllStats();
    updateDataStatus();
    initPairSelect();
  }catch(e){
    document.getElementById('loading').innerHTML='<p style="color:var(--danger)">âŒ '+e.message+'</p><button class="btn btn-primary" style="margin-top:16px" onclick="location.reload()">ë‹¤ì‹œ ì‹œë„</button>';
  }
}

// ìœ í‹¸ë¦¬í‹°
function getBallClass(n){return n<=10?'b1':n<=20?'b2':n<=30?'b3':n<=40?'b4':'b5'}
function createBall(n,size='',extra=''){return '<div class="ball '+size+' '+getBallClass(n)+' '+extra+'">'+n+'</div>'}
function createBalls(nums,bonus=null,size='sm',matched=[]){
  let h=nums.map(n=>createBall(n,size,matched.includes(n)?'matched':'')).join('');
  if(bonus!=null) h+='<span class="plus">+</span>'+createBall(bonus,size,matched.includes(bonus)?'matched bonus':'bonus');
  return h;
}
function formatMoney(a){if(!a)return'-';if(a>=1e8)return(a/1e8).toFixed(1)+'ì–µ';if(a>=1e4)return Math.floor(a/1e4).toLocaleString()+'ë§Œ';return a.toLocaleString()}
function formatDate(d){return d&&d.length===8?d.slice(0,4)+'.'+d.slice(4,6)+'.'+d.slice(6,8):''}
function calcNetPrize(a){if(!a)return 0;return a>3e8?a-(3e8*.22)-((a-3e8)*.33):a*.78}

// ì„¹ì…˜/íƒ­
function showSection(id,el){
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  el.classList.add('active');
  document.getElementById('sec-'+id).classList.add('active');
  window.scrollTo(0,0);
}
function showStatTab(id,el){
  document.querySelectorAll('#sec-stats .tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.stat-content').forEach(c=>c.style.display='none');
  el.classList.add('active');
  document.getElementById('stat-'+id).style.display='block';
}

// ì•„ì½”ë””ì–¸
function toggleAccordion(id){document.getElementById(id).classList.toggle('open')}

// ë²ˆí˜¸ ê·¸ë¦¬ë“œ ì´ˆê¸°í™”
function initAllGrids(){
  ['checkGrid','excludeGrid','requireGrid','wheelGrid'].forEach(gid=>{
    const g=document.getElementById(gid);g.innerHTML='';
    for(let i=1;i<=45;i++){
      const b=document.createElement('button');
      b.className='number-btn '+getBallClass(i);
      b.textContent=i;
      b.onclick=()=>toggleGridNumber(gid,i,b);
      g.appendChild(b);
    }
  });
}
function toggleGridNumber(gid,num,btn){
  if(gid==='checkGrid'){
    if(checkNumbers.has(num)){checkNumbers.delete(num);btn.classList.remove('selected')}
    else if(checkNumbers.size<6){checkNumbers.add(num);btn.classList.add('selected')}
    updateMyNumDisplay();
  }else if(gid==='excludeGrid'){
    if(excludedNumbers.has(num)){excludedNumbers.delete(num);btn.classList.remove('excluded')}
    else{excludedNumbers.add(num);requiredNumbers.delete(num);btn.classList.add('excluded');
      document.querySelectorAll('#requireGrid .number-btn')[num-1].classList.remove('required')}
    updateExcludeDisplay();
  }else if(gid==='requireGrid'){
    if(requiredNumbers.has(num)){requiredNumbers.delete(num);btn.classList.remove('required')}
    else if(requiredNumbers.size<5&&!excludedNumbers.has(num)){requiredNumbers.add(num);btn.classList.add('required')}
    updateRequireDisplay();
  }else if(gid==='wheelGrid'){
    if(wheelNumbers.has(num)){wheelNumbers.delete(num);btn.classList.remove('selected')}
    else if(wheelNumbers.size<15){wheelNumbers.add(num);btn.classList.add('selected')}
    updateWheelDisplay();
  }
}
function updateMyNumDisplay(){
  const nums=[...checkNumbers].sort((a,b)=>a-b);
  document.getElementById('myNumDisplay').innerHTML=nums.length?nums.map(n=>createBall(n,'xs')).join(''):'';
}
function updateExcludeDisplay(){
  const nums=[...excludedNumbers].sort((a,b)=>a-b);
  document.getElementById('excludeDisplay').textContent=nums.length?nums.join(', '):'';
}
function updateRequireDisplay(){
  const nums=[...requiredNumbers].sort((a,b)=>a-b);
  document.getElementById('requireDisplay').textContent=nums.length?nums.join(', '):'';
}
function updateWheelDisplay(){
  const nums=[...wheelNumbers].sort((a,b)=>a-b);
  document.getElementById('wheelDisplay').textContent=nums.length?nums.join(', ')+'('+nums.length+'ê°œ)':'';
}
function clearCheck(){
  checkNumbers.clear();
  document.querySelectorAll('#checkGrid .number-btn').forEach(b=>b.classList.remove('selected'));
  updateMyNumDisplay();
  document.getElementById('checkResult').innerHTML='';
}

// íšŒì°¨ ë„¤ë¹„ê²Œì´ì…˜
function renderCurrentRound(){
  const item=lottoData[currentIndex];if(!item)return;
  document.getElementById('currentRound').textContent=item.round+'íšŒ';
  document.getElementById('currentDate').textContent=formatDate(item.date);
  
  // ë‚´ ë²ˆí˜¸ì™€ ë¹„êµí•˜ì—¬ ì¼ì¹˜ í‘œì‹œ
  const matched=checkNumbers.size===6?[...checkNumbers].filter(n=>item.numbers.includes(n)):[];
  const bonusMatch=checkNumbers.has(item.bonus);
  document.getElementById('currentBalls').innerHTML=createBalls(item.numbers,item.bonus,'',matched);
  
  // ë‹¹ì²¨ê¸ˆ í‘œì‹œ
  const p1=item.rank1?.prize||0,w1=item.rank1?.winners||0;
  document.getElementById('prize1').textContent=formatMoney(p1)+'ì›';
  document.getElementById('prize1Net').textContent='ì‹¤ìˆ˜ë ¹: '+formatMoney(calcNetPrize(p1))+'ì›';
  document.getElementById('prize1Info').textContent=w1+'ëª… ë‹¹ì²¨';
  
  const p2=item.rank2?.prize||0,w2=item.rank2?.winners||0;
  document.getElementById('prize2').textContent=formatMoney(p2)+'ì›';
  document.getElementById('prize2Info').textContent=w2+'ëª…';
  
  const p3=item.rank3?.prize||0,w3=item.rank3?.winners||0;
  document.getElementById('prize3').textContent=formatMoney(p3)+'ì›';
  document.getElementById('prize3Info').textContent=w3+'ëª…';
  
  document.getElementById('totalSales').textContent=formatMoney(item.totalSales)+'ì›';
  document.getElementById('totalWinners').textContent=(item.totalWinners||0).toLocaleString()+'ëª…';
  
  document.getElementById('prevBtn').disabled=currentIndex>=lottoData.length-1;
  document.getElementById('nextBtn').disabled=currentIndex<=0;
  
  // ë‚´ ë²ˆí˜¸ ì…ë ¥ë˜ì–´ ìˆìœ¼ë©´ ìë™ ë¹„êµ
  if(checkNumbers.size===6) autoCompare();
}
function prevRound(){if(currentIndex<lottoData.length-1){currentIndex++;renderCurrentRound()}}
function nextRound(){if(currentIndex>0){currentIndex--;renderCurrentRound()}}
function openRoundModal(){document.getElementById('roundModal').classList.add('active');document.getElementById('roundInput').value='';document.getElementById('roundInput').focus()}
function closeRoundModal(){document.getElementById('roundModal').classList.remove('active')}
function goToRound(){
  const r=parseInt(document.getElementById('roundInput').value);
  const idx=lottoData.findIndex(d=>d.round===r);
  if(idx!==-1){currentIndex=idx;renderCurrentRound();closeRoundModal()}
  else alert('í•´ë‹¹ íšŒì°¨ê°€ ì—†ìŠµë‹ˆë‹¤');
}
document.getElementById('roundModal').onclick=function(e){if(e.target===this)closeRoundModal()};
document.getElementById('roundInput').onkeypress=function(e){if(e.key==='Enter')goToRound()};

// ë‹¹ì²¨ í™•ì¸
function checkMyNumbers(){
  if(checkNumbers.size!==6){
    document.getElementById('checkResult').innerHTML='<div class="alert alert-danger">6ê°œ ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>';
    return;
  }
  autoCompare();
}
function autoCompare(){
  const item=lottoData[currentIndex];
  const my=[...checkNumbers],win=item.numbers,bonus=item.bonus;
  const matched=my.filter(n=>win.includes(n)),bm=my.includes(bonus);
  
  let rank='ë‚™ì²¨',prize=0,isWin=false;
  if(matched.length===6){rank='ğŸ¥‡ 1ë“±';prize=item.rank1?.prize||0;isWin=true}
  else if(matched.length===5&&bm){rank='ğŸ¥ˆ 2ë“±';prize=item.rank2?.prize||0;isWin=true}
  else if(matched.length===5){rank='ğŸ¥‰ 3ë“±';prize=item.rank3?.prize||0;isWin=true}
  else if(matched.length===4){rank='4ë“±';prize=50000;isWin=true}
  else if(matched.length===3){rank='5ë“±';prize=5000;isWin=true}
  
  let html='<div class="check-result"><div class="check-rank '+(isWin?'win':'lose')+'">'+rank+'</div>';
  if(isWin&&prize>5000) html+='<div style="font-size:18px;font-weight:700;margin:8px 0">'+formatMoney(prize)+'ì›</div><div style="color:var(--success);font-size:12px">ì‹¤ìˆ˜ë ¹: '+formatMoney(calcNetPrize(prize))+'ì›</div>';
  else if(isWin) html+='<div style="font-size:16px;margin:8px 0">'+prize.toLocaleString()+'ì›</div>';
  html+='<div style="color:var(--text2);font-size:12px;margin-top:8px">'+matched.length+'ê°œ ì¼ì¹˜'+(bm?' + ë³´ë„ˆìŠ¤':'')+'</div></div>';
  
  document.getElementById('checkResult').innerHTML=html;
  renderCurrentRound(); // ì¼ì¹˜ ë²ˆí˜¸ í‘œì‹œ ê°±ì‹ 
}

// í†µê³„ ê³„ì‚°
function calculateAllStats(){
  numStats=[];
  const freq={},lastSeen={},pairs={};
  for(let i=1;i<=45;i++){freq[i]=0;lastSeen[i]=lottoData.length;pairs[i]={}}
  
  lottoData.forEach((item,idx)=>{
    item.numbers.forEach(n=>{
      freq[n]++;
      if(idx<lastSeen[n])lastSeen[n]=idx;
      // ê¶í•© ê³„ì‚°
      item.numbers.forEach(m=>{if(n!==m){pairs[n][m]=(pairs[n][m]||0)+1}});
    });
  });
  
  const total=lottoData.length;
  const vals=Object.values(freq);
  const mean=vals.reduce((a,b)=>a+b,0)/45;
  const std=Math.sqrt(vals.reduce((s,v)=>s+Math.pow(v-mean,2),0)/45);
  
  for(let i=1;i<=45;i++){
    numStats.push({
      num:i,
      count:freq[i],
      percent:(freq[i]/(total*6)*100).toFixed(2),
      last:lastSeen[i],
      zscore:((freq[i]-mean)/std).toFixed(2)
    });
  }
  
  pairData=pairs;
  window.statMean=mean;
  window.statStd=std;
}

// ë²ˆí˜¸ë³„ í†µê³„ ë Œë”ë§
function renderNumTable(){
  let data=[...numStats];
  
  if(numFilter==='1-10')data=data.filter(d=>d.num<=10);
  else if(numFilter==='11-20')data=data.filter(d=>d.num>10&&d.num<=20);
  else if(numFilter==='21-30')data=data.filter(d=>d.num>20&&d.num<=30);
  else if(numFilter==='31-40')data=data.filter(d=>d.num>30&&d.num<=40);
  else if(numFilter==='41-45')data=data.filter(d=>d.num>40);
  else if(numFilter==='hot')data=data.filter(d=>parseFloat(d.zscore)>1.5);
  else if(numFilter==='cold')data=data.filter(d=>parseFloat(d.zscore)<-1.5);
  
  data.sort((a,b)=>{
    let va=a[numSort.key],vb=b[numSort.key];
    if(typeof va==='string'){va=parseFloat(va);vb=parseFloat(vb)}
    return numSort.asc?va-vb:vb-va;
  });
  
  document.getElementById('numTableBody').innerHTML=data.map(d=>{
    const z=parseFloat(d.zscore);
    let status='',sc='var(--text2)';
    if(z>1.5){status='ğŸ”¥';sc='var(--danger)'}
    else if(z<-1.5){status='â„ï¸';sc='#4dabf7'}
    return '<tr><td>'+createBall(d.num,'xs')+'</td><td>'+d.count+'</td><td>'+d.percent+'%</td><td>'+(d.last===0?'ìµœê·¼':d.last+'íšŒì „')+'</td><td style="color:'+(z>0?'var(--danger)':'#4dabf7')+'">'+d.zscore+'</td><td style="color:'+sc+'">'+status+'</td></tr>';
  }).join('');
}
function sortNum(key){if(numSort.key===key)numSort.asc=!numSort.asc;else{numSort.key=key;numSort.asc=true}renderNumTable()}
function filterNum(f,el){numFilter=f;document.querySelectorAll('#stat-number .filter-chip').forEach(c=>c.classList.remove('active'));el.classList.add('active');renderNumTable()}

// ê¶í•© ë²ˆí˜¸
function initPairSelect(){
  const sel=document.getElementById('pairSelect');
  for(let i=1;i<=45;i++) sel.innerHTML+='<option value="'+i+'">'+i+'</option>';
}
function showPairNumbers(){
  const num=parseInt(document.getElementById('pairSelect').value);
  if(!num){document.getElementById('pairResult').innerHTML='';return}
  
  const pairs=pairData[num];
  const sorted=Object.entries(pairs).sort((a,b)=>b[1]-a[1]).slice(0,6);
  
  document.getElementById('pairResult').innerHTML='<div class="pair-grid">'+sorted.map(([n,c])=>'<div class="pair-item">'+createBall(parseInt(n),'xs')+'<div style="margin-top:4px;color:var(--text2)">'+c+'íšŒ</div></div>').join('')+'</div>';
}

// íšŒì°¨ë³„ í†µê³„ ë Œë”ë§
function renderRoundStats(){
  const total=lottoData.length;
  const oe=[0,0,0,0,0,0,0],hl=[0,0,0,0,0,0,0],endNums={},colors={'1-10':0,'11-20':0,'21-30':0,'31-40':0,'41-45':0};
  let sums=[],consec=0,acSum=0,carryCount=[0,0,0,0,0,0,0],gapSum=0,gapCnt=0;
  for(let i=0;i<=9;i++)endNums[i]=0;
  
  lottoData.forEach((item,idx)=>{
    const nums=item.numbers;
    const odd=nums.filter(n=>n%2===1).length;
    const low=nums.filter(n=>n<=22).length;
    oe[odd]++;hl[low]++;
    
    const sum=nums.reduce((a,b)=>a+b,0);
    sums.push(sum);
    
    nums.forEach(n=>{
      endNums[n%10]++;
      if(n<=10)colors['1-10']++;
      else if(n<=20)colors['11-20']++;
      else if(n<=30)colors['21-30']++;
      else if(n<=40)colors['31-40']++;
      else colors['41-45']++;
    });
    
    const sorted=[...nums].sort((a,b)=>a-b);
    for(let i=0;i<sorted.length-1;i++){
      if(sorted[i+1]-sorted[i]===1)consec++;
      gapSum+=sorted[i+1]-sorted[i];
      gapCnt++;
    }
    
    const diffs=new Set();
    for(let i=0;i<nums.length;i++)for(let j=i+1;j<nums.length;j++)diffs.add(Math.abs(nums[j]-nums[i]));
    acSum+=diffs.size-5;
    
    // ì´ì›” ë¶„ì„
    if(idx<lottoData.length-1){
      const prevNums=lottoData[idx+1].numbers;
      const carry=nums.filter(n=>prevNums.includes(n)).length;
      carryCount[carry]++;
    }
  });
  
  // í™€ì§
  document.getElementById('oddEvenBody').innerHTML=oe.map((v,i)=>'<tr><td>'+i+':'+(6-i)+'</td><td>'+v+'</td><td>'+(v/total*100).toFixed(1)+'%</td></tr>').join('');
  
  // ê³ ì €
  document.getElementById('highLowBody').innerHTML=hl.map((v,i)=>'<tr><td>'+i+':'+(6-i)+'</td><td>'+v+'</td><td>'+(v/total*100).toFixed(1)+'%</td></tr>').join('');
  
  // ì´í•©
  const avgSum=(sums.reduce((a,b)=>a+b,0)/total).toFixed(1);
  const minSum=Math.min(...sums),maxSum=Math.max(...sums);
  const oddSum=sums.filter(s=>s%2===1).length;
  document.getElementById('sumStats').innerHTML='<div class="info-row"><span>í‰ê· </span><span>'+avgSum+'</span></div><div class="info-row"><span>ë²”ìœ„</span><span>'+minSum+' ~ '+maxSum+'</span></div><div class="info-row"><span>í™€ìˆ˜ í•©ê³„</span><span>'+oddSum+'íšŒ ('+(oddSum/total*100).toFixed(1)+'%)</span></div><div class="info-row"><span>ì§ìˆ˜ í•©ê³„</span><span>'+(total-oddSum)+'íšŒ</span></div>';
  
  // ì—°ì†/AC
  const avgAC=(acSum/total).toFixed(2);
  const avgGap=(gapSum/gapCnt).toFixed(1);
  document.getElementById('consecStats').innerHTML='<div class="info-row"><span>ì—°ì†ë²ˆí˜¸ ìŒ</span><span>ì´ '+consec+'ìŒ (í‰ê·  '+(consec/total).toFixed(2)+'/íšŒì°¨)</span></div><div class="info-row"><span>í‰ê·  ACê°’</span><span>'+avgAC+' (0~10)</span></div><div class="info-row"><span>í‰ê·  ë²ˆí˜¸ê°„ê²©</span><span>'+avgGap+'</span></div>';
  
  // ì´ì›”
  document.getElementById('carryStats').innerHTML=carryCount.map((v,i)=>'<div class="info-row"><span>'+i+'ê°œ ì´ì›”</span><span>'+v+'íšŒ ('+(v/(total-1)*100).toFixed(1)+'%)</span></div>').join('');
  
  // ëìˆ˜
  const totalEndNums=Object.values(endNums).reduce((a,b)=>a+b,0);
  document.getElementById('endNumBody').innerHTML=Object.entries(endNums).map(([k,v])=>'<tr><td>'+k+'</td><td>'+v+'</td><td>'+(v/totalEndNums*100).toFixed(1)+'%</td></tr>').join('');
  
  // ê°„ê²©
  document.getElementById('gapStats').innerHTML='<div class="info-row"><span>í‰ê·  ê°„ê²©</span><span>'+avgGap+'</span></div><p style="font-size:11px;color:var(--text2);margin-top:8px">ë²ˆí˜¸ë¥¼ ì •ë ¬í–ˆì„ ë•Œ ì¸ì ‘ ë²ˆí˜¸ ê°„ì˜ ì°¨ì´</p>';
  
  // ìƒ‰ìƒ
  document.getElementById('colorBody').innerHTML=Object.entries(colors).map(([k,v])=>'<tr><td style="color:'+getColorByRange(k)+'">'+k+'</td><td>'+(v/total).toFixed(2)+'ê°œ</td><td>'+(v/(total*6)*100).toFixed(1)+'%</td></tr>').join('');
}
function getColorByRange(r){
  if(r==='1-10')return'#ffd700';if(r==='11-20')return'#4dabf7';if(r==='21-30')return'#ff6b6b';if(r==='31-40')return'#868e96';return'#51cf66';
}

function renderAllStats(){renderNumTable();renderRoundStats()}

// ì˜ˆì¸¡ ì˜µì…˜
function toggleOption(el,opt){
  el.classList.toggle('checked');
  if(predictOptions.has(opt))predictOptions.delete(opt);
  else predictOptions.add(opt);
}

function adjustCount(d){predictCount=Math.max(1,Math.min(10,predictCount+d));document.getElementById('predictCount').textContent=predictCount}

function generatePrediction(){
  const results=[];
  const available=[];
  for(let i=1;i<=45;i++)if(!excludedNumbers.has(i))available.push(i);
  
  // HOT/COLD ë²ˆí˜¸ ë¯¸ë¦¬ ê³„ì‚°
  const hotNums=numStats.filter(d=>parseFloat(d.zscore)>1.5).map(d=>d.num);
  const coldNums=numStats.filter(d=>parseFloat(d.zscore)<-1.5).map(d=>d.num);
  const longAbsentNums=numStats.filter(d=>d.last>=10).sort((a,b)=>b.last-a.last).slice(0,10).map(d=>d.num);
  const recentFreq={};
  for(let i=1;i<=45;i++)recentFreq[i]=0;
  lottoData.slice(0,10).forEach(item=>item.numbers.forEach(n=>recentFreq[n]++));
  
  for(let set=0;set<predictCount;set++){
    let attempts=0,selected=null;
    
    while(attempts<100){
      attempts++;
      selected=[...requiredNumbers];
      const pool=available.filter(n=>!requiredNumbers.has(n));
      
      // ì˜µì…˜ì— ë”°ë¥¸ ê°€ì¤‘ì¹˜ ì ìš©
      let weights={};
      pool.forEach(n=>weights[n]=1);
      
      if(predictOptions.has('hot'))hotNums.forEach(n=>{if(weights[n])weights[n]+=2});
      if(predictOptions.has('cold'))coldNums.forEach(n=>{if(weights[n])weights[n]+=2});
      if(predictOptions.has('recentTrend'))pool.forEach(n=>weights[n]+=recentFreq[n]);
      if(predictOptions.has('longAbsent'))longAbsentNums.forEach(n=>{if(weights[n])weights[n]+=2});
      
      // ê°€ì¤‘ì¹˜ ê¸°ë°˜ ì„ íƒ
      while(selected.length<6&&pool.length>0){
        const totalWeight=pool.reduce((s,n)=>s+weights[n],0);
        let r=Math.random()*totalWeight,cumul=0,chosen=pool[0];
        for(const n of pool){cumul+=weights[n];if(r<=cumul){chosen=n;break}}
        selected.push(chosen);
        pool.splice(pool.indexOf(chosen),1);
      }
      
      selected.sort((a,b)=>a-b);
      
      // ì¡°ê±´ ê²€ì¦
      let valid=true;
      const sum=selected.reduce((a,b)=>a+b,0);
      const oddCnt=selected.filter(n=>n%2===1).length;
      const lowCnt=selected.filter(n=>n<=22).length;
      const colorCnt={'1-10':0,'11-20':0,'21-30':0,'31-40':0,'41-45':0};
      selected.forEach(n=>{if(n<=10)colorCnt['1-10']++;else if(n<=20)colorCnt['11-20']++;else if(n<=30)colorCnt['21-30']++;else if(n<=40)colorCnt['31-40']++;else colorCnt['41-45']++});
      const endNums=new Set(selected.map(n=>n%10));
      let hasConsec=false;
      for(let i=0;i<selected.length-1;i++)if(selected[i+1]-selected[i]===1)hasConsec=true;
      
      if(predictOptions.has('oddEven')&&oddCnt!==3)valid=false;
      if(predictOptions.has('highLow')&&lowCnt!==3)valid=false;
      if(predictOptions.has('sumRange')&&(sum<100||sum>175))valid=false;
      if(predictOptions.has('noConsec')&&hasConsec)valid=false;
      if(predictOptions.has('colorBalance')&&Math.max(...Object.values(colorCnt))>2)valid=false;
      if(predictOptions.has('endNumBalance')&&endNums.size<4)valid=false;
      
      if(valid)break;
    }
    
    if(selected&&selected.length===6)results.push(selected);
  }
  
  document.getElementById('predictResults').innerHTML=results.map((nums,i)=>{
    const sum=nums.reduce((a,b)=>a+b,0);
    const odd=nums.filter(n=>n%2===1).length;
    return '<div class="predict-result"><div class="predict-index">'+(i+1)+'ë²ˆ <span style="color:var(--text2);font-size:10px">í•©:'+sum+' í™€:'+odd+'</span></div><div class="balls">'+createBalls(nums,null,'sm')+'</div></div>';
  }).join('')||'<div class="alert alert-danger">ì¡°ê±´ì— ë§ëŠ” ì¡°í•©ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>';
}

// ì¶•ì†Œ ì‹œìŠ¤í…œ
function generateWheel(){
  if(wheelNumbers.size<6){
    document.getElementById('wheelResults').innerHTML='<div class="alert alert-danger">ìµœì†Œ 6ê°œ ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>';
    return;
  }
  if(wheelNumbers.size>12){
    document.getElementById('wheelResults').innerHTML='<div class="alert alert-danger">ìµœëŒ€ 12ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤ (ì¡°í•© ìˆ˜ ì œí•œ)</div>';
    return;
  }
  
  const nums=[...wheelNumbers].sort((a,b)=>a-b);
  const combos=[];
  
  function combine(start,combo){
    if(combo.length===6){combos.push([...combo]);return}
    for(let i=start;i<nums.length;i++){
      combo.push(nums[i]);
      combine(i+1,combo);
      combo.pop();
    }
  }
  combine(0,[]);
  
  document.getElementById('wheelResults').innerHTML='<div class="wheel-info">ì´ '+combos.length+'ê°œ ì¡°í•©</div><div class="wheel-result">'+combos.slice(0,50).map((c,i)=>'<div class="wheel-item">'+(i+1)+'. '+c.join(', ')+'</div>').join('')+(combos.length>50?'<div class="wheel-item" style="color:var(--text2)">... ì™¸ '+(combos.length-50)+'ê°œ</div>':'')+'</div>';
}

// ì„¤ì •
function updateDataStatus(){
  if(!lottoData.length){document.getElementById('dataStatus').innerHTML='ë°ì´í„° ì—†ìŒ';return}
  const first=lottoData[lottoData.length-1],last=lottoData[0];
  document.getElementById('dataStatus').innerHTML='<div class="info-row"><span>ì´ íšŒì°¨</span><span><strong>'+lottoData.length+'íšŒ</strong></span></div><div class="info-row"><span>ë²”ìœ„</span><span>'+first.round+'íšŒ ~ '+last.round+'íšŒ</span></div><div class="info-row"><span>ìµœì‹  ì¶”ì²¨ì¼</span><span>'+formatDate(last.date)+'</span></div>';
}
function exportData(){
  const b=new Blob([JSON.stringify(lottoData,null,2)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='lotto_data.json';a.click();
}

init();
</script>
</body>
</html>
